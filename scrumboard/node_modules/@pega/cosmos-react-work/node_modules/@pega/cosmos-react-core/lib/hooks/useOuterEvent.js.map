{"version":3,"file":"useOuterEvent.js","sourceRoot":"","sources":["../../src/hooks/useOuterEvent.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,WAAW,EAAa,MAAM,OAAO,CAAC;AAE1D;;;;;GAKG;AACH,MAAM,aAAa,GAAG,CACpB,SAAkC,EAClC,KAA+C,EAC/C,OAAqD,EAC/C,EAAE;IACR,MAAM,OAAO,GAAmB,WAAW,CACzC,KAAK,CAAC,EAAE;QACN,MAAM,IAAI,GAAG,KAAK,CAAC,YAAY,EAAE,CAAC;QAClC,MAAM,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;QAEvB,IAAI,CAAC,CAAC,MAAM,YAAY,IAAI,CAAC;YAAE,OAAO;QAEtC,IAAI,QAAQ,GAAG,CAAC,CAAC;QACjB,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;YAClC,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC7B,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;YAE/B,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM;gBAAE,OAAO;YAE9B,IAAI,MAAM,YAAY,gBAAgB,IAAI,MAAM,YAAY,QAAQ,EAAE;gBACpE,IAAI,CAAC,CAAC,KAAK,YAAY,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC;oBAAE,OAAO;gBAEhE,QAAQ,GAAG,SAAS,CAAC;aACtB;iBAAM,IAAI,KAAK,YAAY,gBAAgB,EAAE;gBAC5C,IAAI,CAAC,CAAC,MAAM,YAAY,OAAO,CAAC,IAAI,MAAM,CAAC,UAAU,KAAK,KAAK;oBAAE,OAAO;gBAExE,QAAQ,GAAG,SAAS,CAAC;aACtB;YAED,SAAS,IAAI,CAAC,CAAC;SAChB;QAED,IACE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;YACd,MAAM,IAAI,GAAG,CAAC,YAAY,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC;YAEhD,IAAI,CAAC,IAAI;gBAAE,OAAO,IAAI,CAAC;YACvB,OAAO,IAAI,KAAK,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACnD,CAAC,CAAC,EACF;YACA,OAAO,CAAC,KAAK,CAAC,CAAC;SAChB;IACH,CAAC,EACD,CAAC,GAAG,KAAK,EAAE,OAAO,CAAC,CACpB,CAAC;IAEF,SAAS,CAAC,GAAG,EAAE;QACb,MAAM,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;QAEtE,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,QAAQ,CAAC,gBAAgB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;QACvE,OAAO,GAAG,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,QAAQ,CAAC,mBAAmB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;IACzF,CAAC,EAAE,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,CAAC;AAC3B,CAAC,CAAC;AAEF,eAAe,aAAa,CAAC","sourcesContent":["import { useEffect, useCallback, RefObject } from 'react';\n\n/**\n * @example useOuterEvent(eventName, [nodes], handler = () => { doSomething; });\n * @param eventName The type of event to trigger the handler function on. Reference [DocumentEventMap](https://microsoft.github.io/PowerBI-JavaScript/interfaces/_node_modules_typedoc_node_modules_typescript_lib_lib_dom_d_.documenteventmap.html) for a list of valid events.\n * @param nodes An array of Nodes or Refs to Nodes to attach the eventName to.\n * @param handler The function that is called when the given event occurs.\n */\nconst useOuterEvent = <EventName extends keyof DocumentEventMap>(\n  eventName: EventName | EventName[],\n  nodes: (Node | null | RefObject<Node | null>)[],\n  handler: (event: DocumentEventMap[EventName]) => void\n): void => {\n  const onEvent: typeof handler = useCallback(\n    event => {\n      const path = event.composedPath();\n      const target = path[0];\n\n      if (!(target instanceof Node)) return;\n\n      let childIdx = 0;\n      let parentIdx = 1;\n      while (path[childIdx] !== document) {\n        const child = path[childIdx];\n        const parent = path[parentIdx];\n\n        if (!child || !parent) return;\n\n        if (parent instanceof DocumentFragment || parent instanceof Document) {\n          if (!(child instanceof Node) || !parent.contains(child)) return;\n\n          childIdx = parentIdx;\n        } else if (child instanceof DocumentFragment) {\n          if (!(parent instanceof Element) || parent.shadowRoot !== child) return;\n\n          childIdx = parentIdx;\n        }\n\n        parentIdx += 1;\n      }\n\n      if (\n        nodes.every(n => {\n          const node = n instanceof Node ? n : n?.current;\n\n          if (!node) return true;\n          return node !== target && !node.contains(target);\n        })\n      ) {\n        handler(event);\n      }\n    },\n    [...nodes, handler]\n  );\n\n  useEffect(() => {\n    const eventNames = Array.isArray(eventName) ? eventName : [eventName];\n\n    eventNames.forEach(event => document.addEventListener(event, onEvent));\n    return () => eventNames.forEach(event => document.removeEventListener(event, onEvent));\n  }, [eventName, onEvent]);\n};\n\nexport default useOuterEvent;\n"]}