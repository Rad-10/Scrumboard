{"version":3,"file":"useDraggable.js","sourceRoot":"","sources":["../../src/hooks/useDraggable.ts"],"names":[],"mappings":"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","sourcesContent":["import { useState, useEffect, RefObject, useRef } from 'react';\n\nconst interactiveElementsTags = ['button', 'a', 'input', 'textarea', 'select', 'details'];\n\nconst shouldIgnoreEvent = (event: MouseEvent | TouchEvent): boolean => {\n  return interactiveElementsTags.some(\n    tag => event.target instanceof Element && event.target.tagName.toLowerCase() === tag\n  );\n};\n\n/**\n * @param draggableElementRef Reference to the element which is draggable.\n * @param dragHandleRef Reference to the handle element which allows to move draggableElementRef.\n */\nconst useDraggable = (\n  draggableElementRef: RefObject<HTMLElement>,\n  dragHandleRef: RefObject<HTMLElement>,\n  enabled: boolean = true\n) => {\n  const [dragging, setDragging] = useState(false);\n  const draggableElPosition = useRef({ x: 0, y: 0 });\n\n  useEffect(() => {\n    if (!enabled) return;\n    const onMouseDown = (event: MouseEvent | TouchEvent): void => {\n      if (shouldIgnoreEvent(event)) return;\n      setDragging(true);\n      if (draggableElementRef.current) {\n        const { clientX, clientY } = 'touches' in event ? event.touches[0] : event;\n        draggableElPosition.current.x =\n          clientX - draggableElementRef.current.getBoundingClientRect().left;\n        draggableElPosition.current.y =\n          clientY - draggableElementRef.current.getBoundingClientRect().top;\n      }\n    };\n\n    if (dragHandleRef.current) {\n      // Save the current value so we can properly remove event listener after the ref has changed.\n      const { current } = dragHandleRef;\n\n      current.addEventListener('mousedown', onMouseDown);\n      current.addEventListener('touchstart', onMouseDown);\n\n      return () => {\n        current.removeEventListener('mousedown', onMouseDown);\n        current.removeEventListener('touchstart', onMouseDown);\n      };\n    }\n  }, [dragHandleRef.current, enabled]);\n\n  useEffect(() => {\n    const onWindowResize = () => {\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n      if (draggableElementRef.current) {\n        const limitX = draggableElementRef.current.offsetWidth - windowWidth;\n        const limitY = draggableElementRef.current.offsetHeight - windowHeight;\n\n        const positionX = draggableElementRef.current.getBoundingClientRect().left;\n        const positionY = draggableElementRef.current.getBoundingClientRect().top;\n\n        const horizontal = Math.min(Math.max(positionX, limitX), 0);\n        const vertical = Math.min(Math.max(positionY, limitY), 0);\n\n        draggableElementRef.current.style.transform = `translate(${horizontal}px, ${vertical}px)`;\n      }\n    };\n\n    const onMouseMove = (event: MouseEvent | TouchEvent): void => {\n      const windowWidth = window.innerWidth;\n      const windowHeight = window.innerHeight;\n      if (!dragging) return;\n      if (draggableElementRef.current) {\n        const { clientX, clientY } = 'touches' in event ? event.touches[0] : event;\n        const positionX =\n          clientX - draggableElementRef.current.offsetLeft - draggableElPosition.current.x;\n        const positionY =\n          clientY - draggableElementRef.current.offsetTop - draggableElPosition.current.y;\n\n        const limitX = draggableElementRef.current.offsetWidth - windowWidth;\n        const limitY = draggableElementRef.current.offsetHeight - windowHeight;\n\n        const horizontal = Math.min(Math.max(positionX, limitX), 0);\n        const vertical = Math.min(Math.max(positionY, limitY), 0);\n\n        draggableElementRef.current.style.transform = `translate(${horizontal}px, ${vertical}px)`;\n      }\n    };\n\n    const onMouseUp = (): void => {\n      setDragging(false);\n    };\n\n    window.addEventListener('resize', onWindowResize);\n\n    if (dragging) {\n      document.addEventListener('mouseup', onMouseUp);\n      document.addEventListener('touchend', onMouseUp);\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('touchmove', onMouseMove);\n\n      return () => {\n        document.removeEventListener('mouseup', onMouseUp);\n        document.removeEventListener('touchend', onMouseUp);\n        document.removeEventListener('mousemove', onMouseMove);\n        document.removeEventListener('touchmove', onMouseMove);\n      };\n    }\n    return () => {\n      window.removeEventListener('resize', onWindowResize);\n    };\n  }, [dragging]);\n};\n\nexport default useDraggable;\n"]}