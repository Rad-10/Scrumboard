{"version":3,"file":"NumberUnit.js","sourceRoot":"","sources":["../../../../../src/components/DateTime/Input/Duration/NumberUnit.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ChangeEvent, FC, KeyboardEvent, useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components';\n\nimport { TranslationPack } from '../../../../i18n';\nimport { useI18n, useUID } from '../../../../hooks';\nimport StyledInput from '../../../Input/Input.styles';\nimport { StyledSelect } from '../../../Select/Select';\nimport { ForwardProps } from '../../../../types';\nimport { msToTimeUnit, timeUnitToMs } from '../utils';\nimport StyledDateTime from '../DateTime.styles';\nimport { StyledFormControl } from '../../../FormControl';\nimport Flex from '../../../Flex';\nimport Input from '../../../Input';\nimport Select, { Option } from '../../../Select';\nimport { defaultThemeProp } from '../../../../theme';\n\nimport DurationInputProps, { Format } from './DurationInput.types';\n\nexport const StyledNumberUnit = styled(StyledDateTime)<DurationInputProps>`\n  padding: 0;\n  border: 0;\n  height: auto;\n  &:focus-within:not([readonly]):not([disabled]) {\n    box-shadow: none;\n  }\n  > ${StyledInput} {\n    background-color: transparent;\n    border-start-end-radius: 0;\n    border-end-end-radius: 0;\n  }\n  > ${StyledSelect} {\n    max-width: max-content;\n    margin-inline-start: -0.0625rem;\n    background-color: transparent;\n    border-start-start-radius: 0;\n    border-end-start-radius: 0;\n  }\n  &[readonly] > ${StyledSelect} {\n    color: currentcolor;\n    opacity: 1;\n    cursor: default;\n  }\n  > ${StyledInput}:hover:not([readonly]):not([disabled]) + ${StyledSelect} {\n    border-inline-start: transparent;\n  }\n`;\n\nStyledNumberUnit.defaultProps = defaultThemeProp;\n\ntype NumberUnitProps = DurationInputProps & ForwardProps;\n\nconst OPTIONS = [Format.Seconds, Format.Minutes, Format.Hours, Format.Days];\n\nconst NumberUnit: FC<NumberUnitProps> = (props: DurationInputProps) => {\n  const {\n    defaultValue = 0,\n    value,\n    onChange,\n    format = Format.Seconds,\n    onSelect,\n    disabled,\n    readOnly,\n    required,\n    status,\n    autoFocus,\n    ...restProps\n  } = props;\n  const t = useI18n();\n  const [valueInMs, setValueInMs] = useState<number>(value ?? defaultValue);\n  const [unit, setUnit] = useState<Format>(format);\n\n  useEffect(() => {\n    setUnit(format);\n  }, [format]);\n\n  useEffect(() => {\n    if (value !== undefined) {\n      setValueInMs(value);\n    }\n  }, [value]);\n\n  const onNumberInputChange = useCallback(\n    (ev: ChangeEvent<HTMLInputElement>) => {\n      const inputValue = Number(ev.target.value);\n      if (Number.isNaN(inputValue) || inputValue < 0) return;\n      setValueInMs(timeUnitToMs(inputValue, unit));\n    },\n    [unit]\n  );\n\n  const onInputBlur = useCallback(() => {\n    if (!disabled && !readOnly && onChange) {\n      onChange(valueInMs);\n    }\n  }, [valueInMs, onChange]);\n\n  const onInputKeyDown = useCallback((ev: KeyboardEvent<HTMLInputElement>) => {\n    if (['e', 'E', '+', '-', ',', '.'].includes(ev.key)) ev.preventDefault();\n  }, []);\n\n  const onSelectChange = useCallback(\n    (ev: ChangeEvent<HTMLSelectElement>) => {\n      const selectedValue = ev.target.value as Format;\n      setUnit(selectedValue);\n      onSelect?.(selectedValue);\n    },\n    [onSelect]\n  );\n\n  const unitOptions = OPTIONS.map(option => (\n    <Option key={option} value={option}>\n      {t(`${option}_text` as keyof TranslationPack)}\n    </Option>\n  ));\n\n  const id = useUID();\n\n  return (\n    <Flex\n      as={StyledNumberUnit}\n      forwardedAs={StyledFormControl}\n      container={{ alignItems: 'center', wrap: 'nowrap' }}\n      status={status}\n      readOnly={readOnly}\n      disabled={disabled}\n      {...restProps}\n    >\n      <Input\n        type='number'\n        key='number'\n        placeholder='0'\n        aria-labelledby={id}\n        value={msToTimeUnit(valueInMs, unit) as any}\n        onChange={onNumberInputChange}\n        onBlur={onInputBlur}\n        onKeyDown={onInputKeyDown}\n        required={required}\n        status={status}\n        readOnly={readOnly}\n        disabled={disabled}\n        autoFocus={autoFocus}\n      />\n      <Select\n        id={id}\n        aria-label={t('time_unit')}\n        key='unit'\n        value={unit}\n        required={required}\n        status={status}\n        readOnly={readOnly}\n        disabled={disabled || readOnly}\n        onChange={onSelectChange}\n      >\n        {unitOptions}\n      </Select>\n    </Flex>\n  );\n};\n\nexport default NumberUnit;\n"]}